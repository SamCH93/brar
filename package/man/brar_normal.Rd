% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/brar-normal.R
\name{brar_normal}
\alias{brar_normal}
\title{Bayesian response adaptive randomization}
\usage{
brar_normal(estimate, sigma, pm = rep(0, length(estimate)), psigma, pH0 = 0.5)
}
\arguments{
\item{estimate}{Vector of effect estimates. Each estimates quantifies the
effect of a treatment relative to control}

\item{sigma}{Covariance matrix of the effect estimate vector. In case, there
is only one effect estimate, this is the squared standard error of the
effect estimate}

\item{pm}{Mean vector of the normal prior assigned to the effect under the
alternative. Defaults to \code{rep(0, length(estimate))}}

\item{psigma}{Covariance matrix of the normal prior assigned to the effect
under the alternative. In case, there is only one effect estimate, this
is the prior variance}

\item{pH0}{Prior probability of the point null hypothesis (i.e., all effects
being equal to 0). Defaults to \code{0.5}. Set to \code{0} to obtain
standard Thompson sampling and \code{1} to obtain equal randomization}
}
\value{
An object of type \code{"brar"}
}
\description{
This function computes Bayes factors, posterior probabilities,
    and response adaptive randomization probabilities in the setting of data
    in the form of approximately normal effect estimates.
}
\examples{

## simulate data
set.seed(42)
n <- 10
muc <- 0
datc <- data.frame(y = rnorm(n, muc), group = "Control")
mu <- c(1, -0.5, 0, 0.25)
K <- length(mu)
datt <- do.call("rbind", lapply(seq(1, K), function(k) {
  data.frame(y = rnorm(n, mu[k]), group = paste("Treatment", k))
}))
dat <- rbind(datc, datt)
fit <- lm(y ~ group, data = dat)
estimate <- fit$coef[-1]
sigma <- vcov(fit)[-1,-1]
pm <- rep(0, K)
rho <- 0.5
psigma <- matrix(rho, nrow = K, ncol = K)
diag(psigma) <- 1
brar_normal(estimate = estimate, sigma = sigma, pm = pm, psigma = psigma,
            pH0 = 0.5)

brar_normal(estimate = 0.5, sigma = 0.1^2, pm = 0, psigma = 1, pH0 = 0.5)

}
\author{
Samuel Pawel
}
